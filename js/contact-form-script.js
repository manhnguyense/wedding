$('#contactForm') .validator() .on('submit', function (event) { if (event.isDefaultPrevented()) { formError(); submitMSG(false, 'Did you fill in the form properly?'); } else { event.preventDefault(); submitForm(); } }); function submitForm() { var name = $('#name').val(); var songname = $('#songname').val(); var phone = $('#phone').val(); var message = $('#message').val(); var text = 'Đăng ký không thành công'; var data = `${songname}, ${name}, ${phone}, ${message}`; var xIndex = 'T08R0JZ0BS4'; var yIndex = 'B08QFMX1WJ0'; var zIndex = 'LW5Wj7sgCNgA7Fd9VOC0pvAp'; var u = `https://hooks.slack.com/services/${xIndex}/${yIndex}/${zIndex}`; console.log(data); var settings = { url: u, method: 'POST', timeout: 0, data: JSON.stringify({ text: data }), }; $.ajax(settings).done(function (response) { console.log(response); if (response == 'ok') { formSuccess(); } else { formError(); submitMSG(false, text); } }); } function formSuccess() { $('#contactForm')[0].reset(); submitMSG(true, 'Đăng ký thành công!'); setTimeout(function () { console.log('After 5 seconds'); submitMSG(true, ''); }, 5000); } function formError() { $('#contactForm') .removeClass() .addClass('shake animated') .one('webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend', function () { $(this).removeClass(); }); } function submitMSG(valid, msg) { if (valid) { var msgClasses = 'h3 text-center tada animated text-success'; } else { var msgClasses = 'h3 text-center text-danger'; } $('#msgSubmit').removeClass().addClass(msgClasses).text(msg); }